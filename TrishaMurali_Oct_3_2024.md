Name: Trisha Murali <br/>
Date: 10/03/2024

Note: Here we wrote sections of the design doc. These were some of the sections I contributed to entirely. 

# Lights in Design Doc 

The grow lights subsystem plays multiple roles in plant care. Not only do grow lights help expose the plant to necessary light to promote photosynthesis, but they also produce heat (which is good for many plants). This subsystem is straightforward in that our device will use pre-made grow lights. In the circuit schematic (Figure 18), this is represented by the LED array. Note that this is connected to an n-type MOSFET, which functions as a switch to turn it on/off based on the STM32’s digital output signal labeled and connected to the subsystem as LIGHTGPIO (refer to Figure 13 to see associated connection on STM32). For more information about how the MOSFET switch operates, refer to the Special Note: 5V/12V Switch section. 

The type of plant being grown will determine how much light is necessary. A light sensor (LTR-329) will be used to track the amount of light the plant has received in a 24 hour period, and this will be stored in the STM32’s flash memory. The sensor data will be communicated using I2C protocol. The appropriate connection labels can be seen in Figure 13 and Figure 18. The SCL pin is an I2C serial clock input and the SDA is an I2C serial data input/output pin. According to the datasheet, there’s a read bit that has to be set in order to access the data. Once the data has been read, the status bit is set to 0 to prevent a repeated read of the same data [25]. Let’s take a look at an example: spinach requires 12 hours of light per day along with a temperature of 60-70 degrees Fahrenheit [5]. Maintaining a moderate temperature within the Smart Pot while shining grow lights can be a difficult optimum to reach because they produce heat. This is where the shade and on/off switch for the LEDs come into the picture. Based on sensor output, the STM32 will provide a signal  (STEPGPIOs) to the stepper motor driver ULN2003 to drive the 5V stepper motor (1286-1219-ND), which will in turn operate the shades that provide coverage for the plants as shown in Figure 19. This is done if the Smart Pot is ever too hot, but it has not reached the maximum limit. However, if the plant has received its maximum limit (i.e., if it reaches 12 hours of light in the case of Spinach) during the current 24 hour period, the lights will be turned off. Similarly, if too little light (< 12 hours) has been received, the lights will be turned on. Do note that if the temperature is too high (above 70 degrees F), the device may not turn the lights off if the desired amount of light exposure is not reached (< 12 hours). When this is the case, fans will be actuated for air circulation and the shade will be deployed to help maintain a cooler environment. The shade is a component exclusive to the grow lights subsystem, but because all of the stated environment factors go hand-in-hand, the other subsystems will work together to attain the necessary balance. 

![image](https://github.com/user-attachments/assets/aff42195-fb6e-4c70-bee7-ac8d9d3a8d45)
![image](https://github.com/user-attachments/assets/6443093b-e170-491b-ad86-3c695c00573a)
![image](https://github.com/user-attachments/assets/275fc274-531e-4802-8f17-defce86bf50a)

# Humidity 
The humidity subsystem tracks the humidity levels of the plant’s environment/enclosure, thereby controlling the associated device settings to allow for better air circulation to either increase or decrease the humidity. Different plant types at different stages of their growth require certain levels of humidity. For instance, if the chosen hydroponic plant type was Spinach, it would require 40 to 70 percent humidity levels [6]. Maintaining the numbers between this range is important for the healthy growth of Spinach. This will be attained by tracking real-time data of the humidity levels with a humidity and temperature sensor (SHT35-DIS-F) as shown in Figure 22. If the levels are too high, our device will adjust the vents using the servo motor (HS-311) powered with 5V and signaled by the HUMIDITYGPIO on the STM32 (Figure 20 and Figure 13). Once the ideal humidity level is reached, the vents will maintain this level by closing. The fan from the oxygenation system will also assist in maintaining these levels. It will circulate the air out of the enclosure, getting rid of some of the moist air. Once a measurement within the range necessary for the specific hydroponic plant type is achieved, the fan will be turned off and the vents will be closed. In terms of its behavior and interaction with other subsystems, the humidity sensor will communicate with the STM32 by sending and receiving relevant humidity. This will be done using I2C. 

As shown in Figure 21, the SHT35-DIS-F humidity sensor is powered with 3.3V and has a similar pin configuration to the light sensor with the serial data input/output and serial clock input/output. According to the datasheet of the humidity sensor, the I2C communication requires a clock pulse to be generated as a START condition along with the master requesting a read [26]. The SHT35-DIS-F (used for humidity and air/environment temperature sensing) will then acknowledge this and send data in the format of 2 bytes of temperature data, number of bits sent, 2 bytes of humidity data, number of bits sent. The STM32 will then have to acknowledge the bytes of data sent for the sensor to continually measure and send data. If a value within the ideal range is detected (40 to 70 percent relative humidity with a tolerance of +/- 5% and an enclosure environment/air temperature reading within 60-70 degrees F +/- 5 degrees F), everything will remain as is [10]. If this is not the case and the value is higher than the given range, the servo for the enclosure vent will be powered and the STM32 will send a signal to open the vents and fan out the air. If the value is lower than the range, it will close up any open vents and turn the fans off. The fans will use the MOSFET switches to turn on/off (Figure 22). This is identical to the n-type 5V/12V switch in the other subsystems

![image](https://github.com/user-attachments/assets/f27cd121-f251-4c72-b77f-107e1806d2d6)

# Oxygenation
The oxygenation subsystem oxygenates and agitates the hydroponic water to facilitate plant growth and impede algae and bacteria. It also ensures constant air flow within the Smart Pot enclosure, protecting the plant from rot and mold. To perform these operations, an air stone attached to an air pump will be inserted into the Smart Pot main reservoir. A fan will be incorporated onto the side of the Smart Pot enclosure (clear top of the Smart Pot), and air vents controlled via a motor will be located at the top (of the enclosure). The air stone will continuously run (powered with 5V), while the fan and air vent will be turned on/off and opened/closed on a timed basis and/or if the humidity/temperature levels fall below/above the range respectively. The control unit (STM32) will send a signal to the fan (FANGPIO) and air vent servo motor when the air in the enclosure should be refreshed. This will turn the fan on and open the enclosure vents for some time, followed by them shutting off/closing again. Note that the fan and air vent are also considered a part of the humidity subsystem, and aid in lowering enclosure humidity if it ever is too high. Overall, the oxygenation subsystem is closely tied with the humidity subsystem, and is actuated on by the control subsystem.

![image](https://github.com/user-attachments/assets/40d6b522-0a98-4519-8c96-c9468f2f0338)
